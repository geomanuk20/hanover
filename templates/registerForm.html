{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HANOVER - Profile Registration</title>
    <link rel="icon" href="{% static 'img/real state logo.jpeg' %}" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .main-container {
            width: 75%;
            height: 75vh;
            max-height: 900px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            padding: 30px;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
        }

        .form-col {
            flex: 1;
            min-width: 250px;
            padding: 0 10px;
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        .required:after {
            content: " *";
            color: red;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        select,
        textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }

        input:focus,
        select:focus,
        textarea:focus {
            border-color: #0066cc;
            outline: none;
        }

        select {
            height: 46px;
        }

        .profile-image-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .profile-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            overflow: hidden;
        }

        .profile-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-image-placeholder {
            color: #999;
            font-size: 30px;
        }

        .upload-btn {
            background: #0066cc;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: inline-block;
            transition: background 0.3s;
        }

        .upload-btn:hover {
            background: #0055aa;
        }

        #imageUpload {
            display: none;
        }

        .btn-group {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-cancel {
            background: #f0f0f0;
            color: #333;
        }

        .btn-cancel:hover {
            background: #e0e0e0;
        }

        .btn-submit {
            background: #0066cc;
            color: white;
        }

        .btn-submit:hover {
            background: #0055aa;
        }

        .error {
            border-color: #ff3860 !important;
        }

        .error-message {
            color: #ff3860;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        @media (max-width: 1200px) {
            .main-container {
                width: 85%;
                height: 85vh;
            }
        }

        @media (max-width: 992px) {
            .main-container {
                width: 90%;
                height: 90vh;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                width: 95%;
                height: 95vh;
            }
            
            .form-col {
                flex: 100%;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .main-container {
                padding: 20px;
                height: auto;
                max-height: none;
            }
            
            .profile-image-container {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .profile-image {
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h1>Profile Registration</h1>
        
        <form id="registrationForm" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="profile-image-container">
                <div class="profile-image">
                    {% if form.instance.profile_image %}
                        <img id="profilePreview" src="{{ user.pics.url}}" alt="Profile Image">
                    {% else %}
                        <div class="profile-image-placeholder">
                            <i class="fas fa-user"></i>
                        </div>
                    {% endif %}
                    <img id="profilePreview" src="" style="display: none;">
                </div>
                <div>
                    <label for="imageUpload" class="upload-btn">Add Image</label>
                    <input type="file" id="imageUpload" accept="image/*">
                    <div class="error-message" id="imageError"></div>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="name" class="required">Name</label>
                        <input type="text" id="name" name="name" class="form-control" placeholder="Enter your full name" required>
                        <div class="error-message" id="nameError"></div>
                    </div>
                </div>
                
                <div class="form-col">
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" class="form-control" placeholder="Enter your email">
                        <div class="error-message" id="emailError">{{ form.email.errors }}</div>
                    </div>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="customerType">Customer Type</label>
                        <select id="customertype" name="customertype" class="form-control">
                            <option value="individual">Individual</option>
                            <option value="business">Business</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-col">
                    <div class="form-group">
                        <label for="phone" class="required">Mobile</label>
                        <input type="text" id="phone" name="phone" class="form-control" placeholder="Enter mobile number" value="{{ user.phone_number }}" required>
                        <div class="error-message" id="mobileError"></div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="address" class="required">Address</label>
                <textarea id="address" name="address" class="form-control" rows="3" placeholder="Enter your full address" required></textarea>
                <div class="error-message" id="addressError"></div>
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="country" class="required">Country</label>
                        <select id="country" name="country" class="form-control" required>
                            <option value="">Select Country</option>
                            <option value="India" selected>India</option>
                            <option value="USA">United States</option>
                            <option value="UK">United Kingdom</option>
                            <option value="Canada">Canada</option>
                            <option value="Australia">Australia</option>
                            <option value="Germany">Germany</option>
                            <option value="France">France</option>
                            <option value="Japan">Japan</option>
                            <option value="China">China</option>
                            <option value="Brazil">Brazil</option>
                        </select>
                        <div class="error-message" id="countryError"></div>
                    </div>
                </div>
                
                <div class="form-col">
                    <div class="form-group">
                        <label for="state" class="required">State</label>
                        <select id="state" name="state" class="form-control" required>
                            <option value="">Select State</option>
                            <option value="Kerala" selected>Kerala</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Telangana">Telangana</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Delhi">Delhi</option>
                            <option value="West Bengal">West Bengal</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Punjab">Punjab</option>
                            <option value="Haryana">Haryana</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="Bihar">Bihar</option>
                            <option value="Madhya Pradesh">Madhya Pradesh</option>
                            <option value="Odisha">Odisha</option>
                            <option value="Assam">Assam</option>
                        </select>
                        <div class="error-message" id="stateError"></div>
                    </div>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="district" class="required">District</label>
                        <select id="district" name="district" class="form-control" required>
                            <option value="">Select District</option>
                            <option value="Kozhikode" selected>Kozhikode</option>
                            <option value="Thiruvananthapuram">Thiruvananthapuram</option>
                            <option value="Ernakulam">Ernakulam</option>
                            <option value="Kollam">Kollam</option>
                            <option value="Thrissur">Thrissur</option>
                            <option value="Kannur">Kannur</option>
                            <option value="Alappuzha">Alappuzha</option>
                            <option value="Palakkad">Palakkad</option>
                            <option value="Malappuram">Malappuram</option>
                            <option value="Wayanad">Wayanad</option>
                            <option value="Kasaragod">Kasaragod</option>
                            <option value="Pathanamthitta">Pathanamthitta</option>
                            <option value="Idukki">Idukki</option>
                            <option value="Kottayam">Kottayam</option>
                        </select>
                        <div class="error-message" id="districtError"></div>
                    </div>
                </div>
                
                <div class="form-col">
                    <div class="form-group">
                        <label for="city">City</label>
                        <input type="text" id="city" name="city" class="form-control" placeholder="Enter your city" value="Kunnamangalam">
                        <div class="error-message" id="cityError"></div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="landline">Landline</label>
                <input type="tel" id="landline" name="landline" class="form-control" placeholder="Enter landline number">
                <div class="error-message" id="landlineError"></div>
            </div>
            
            <div class="btn-group">
                <button type="button" class="btn btn-cancel" onclick="window.location.href='/'">Cancel</button>
                <button type="submit" class="btn btn-submit">register</button>
            </div>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Image upload preview
            const imageUpload = document.getElementById('imageUpload');
            const profilePreview = document.getElementById('profilePreview');
            const profilePlaceholder = document.querySelector('.profile-image-placeholder');
            
            imageUpload.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        profilePreview.src = e.target.result;
                        profilePreview.style.display = 'block';
                        profilePlaceholder.style.display = 'none';
                    }
                    
                    reader.readAsDataURL(file);
                }
            });
            
            // Form validation
            const form = document.getElementById('registrationForm');
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                let isValid = true;
                
                // Validate name
                const name = document.getElementById('name');
                if (!name.value.trim()) {
                    showError(name, 'Name is required', 'nameError');
                    isValid = false;
                } else {
                    removeError(name, 'nameError');
                }
                
                // Validate mobile
                const mobile = document.getElementById('phone');
                if (!mobile.value.trim()) {
                    showError(mobile, 'phone number is required', 'mobileError');
                    isValid = false;
                } else if (!/^\d{10}$/.test(mobile.value.trim())) {
                    showError(mobile, 'Please enter a valid 10-digit phone number', 'mobileError');
                    isValid = false;
                } else {
                    removeError(mobile, 'mobileError');
                }
                
                // Validate address
                const address = document.getElementById('address');
                if (!address.value.trim()) {
                    showError(address, 'Address is required', 'addressError');
                    isValid = false;
                } else {
                    removeError(address, 'addressError');
                }
                
                // Validate country
                const country = document.getElementById('country');
                if (!country.value) {
                    showError(country, 'Country is required', 'countryError');
                    isValid = false;
                } else {
                    removeError(country, 'countryError');
                }
                
                // Validate state
                const state = document.getElementById('state');
                if (!state.value) {
                    showError(state, 'State is required', 'stateError');
                    isValid = false;
                } else {
                    removeError(state, 'stateError');
                }
                
                // Validate district
                const district = document.getElementById('district');
                if (!district.value) {
                    showError(district, 'District is required', 'districtError');
                    isValid = false;
                } else {
                    removeError(district, 'districtError');
                }
                
                // If all validations pass, submit the form
                if (isValid) {
                    alert('Form submitted successfully!');
                    form.submit(); // Uncomment this to actually submit the form
                }
            });
            
            // Helper functions
            function showError(input, message, errorId) {
                input.classList.add('error');
                const errorElement = document.getElementById(errorId);
                errorElement.textContent = message;
                errorElement.style.display = 'block';
            }
            
            function removeError(input, errorId) {
                input.classList.remove('error');
                const errorElement = document.getElementById(errorId);
                errorElement.style.display = 'none';
            }
            
            // Cancel button
            document.querySelector('.btn-cancel').addEventListener('click', function() {
                if (confirm('Are you sure you want to cancel?')) {
                    window.location.href = '/'; // Redirect to home or previous page
                }
            });

            // Dynamic state-district relationship (example for Kerala)
            document.getElementById('state').addEventListener('change', function() {
                const districtSelect = document.getElementById('district');
                districtSelect.innerHTML = '<option value="">Select District</option>';
                
                if (this.value === 'Kerala') {
                    const keralaDistricts = [
                        'Alappuzha', 'Ernakulam', 'Idukki', 'Kannur', 'Kasaragod',
                        'Kollam', 'Kottayam', 'Kozhikode', 'Malappuram', 'Palakkad',
                        'Pathanamthitta', 'Thiruvananthapuram', 'Thrissur', 'Wayanad'
                    ];
                    
                    keralaDistricts.forEach(district => {
                        const option = document.createElement('option');
                        option.value = district;
                        option.textContent = district;
                        districtSelect.appendChild(option);
                    });
                }
                // Add similar blocks for other states as needed
            });
        });
    </script>
</body>
</html>